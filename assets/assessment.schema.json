{
  "rule_version": "v1.0.0",
  "steps": [
    {"id": "start", "title": "Let’s define your brief.", "group": "start"},
    {"id": "goals", "title": "Your goals & why", "group": "goals"},
    {"id": "timing", "title": "Timing & experience", "group": "timing"},
    {"id": "finance", "title": "Finance snapshot", "group": "finance"},
    {"id": "property", "title": "Property basics", "group": "property"},
    {"id": "location", "title": "Where should we scan?", "group": "location"},
    {"id": "comparables", "title": "Share up to 3 example properties (optional)", "group": "comparables"}
  ],
  "nodes": [
    {"id":"first_name","prompt":"First name","type":"text","maps_to_field":"client.first_name","step_group":"start"},
    {"id":"last_name","prompt":"Last name","type":"text","maps_to_field":"client.last_name","step_group":"start"},
    {"id":"email","prompt":"Email","type":"text","validation":{"pattern":"[^@\n]+@[^@\n]+\\.[^@\n]+"},"required_when":{"const":true},"maps_to_field":"client.email","step_group":"start"},
    {"id":"mobile","prompt":"Mobile","type":"text","maps_to_field":"client.mobile","step_group":"start"},
    {"id":"current_location","prompt":"Current location (state/country)","type":"text","maps_to_field":"client.location","step_group":"start"},

    {"id":"goals","prompt":"Primary goals","type":"multi_select","options":["Capital growth","Rental yield","Balanced","Cashflow now","Portfolio scale"],"required_when":{"const":true},"maps_to_field":"motivation.goals","step_group":"goals"},
    {"id":"strategy_goal","prompt":"Strategy focus","type":"single_select","options":["High Growth","High Yield","Balanced"],"required_when":{"const":true},"maps_to_field":"strategy.goal","step_group":"goals"},
    {"id":"why","prompt":"Why this investment?","type":"text","maps_to_field":"motivation.why","step_group":"goals"},

    {"id":"timeline","prompt":"When do you want to act?","type":"single_select","options":["Now","1–3 months","3–6 months","6–12 months"],"required_when":{"const":true},"maps_to_field":"engagement.timeline","step_group":"timing"},
    {"id":"experience","prompt":"Experience level","type":"single_select","options":["First‑time","Experienced","Professional"],"maps_to_field":"motivation.experience","step_group":"timing"},
    {"id":"risk_tol","prompt":"Risk tolerance","type":"single_select","options":["Conservative","Moderate","Aggressive"],"required_when":{"const":true},"maps_to_field":"motivation.risk","step_group":"timing"},

    {"id":"price_band","prompt":"Budget (range)","type":"single_select","options":["<500k","500–700k","700–900k","900k–1.2M","1.2–1.5M","1.5M+"],"required_when":{"const":true},"maps_to_field":"finance.price_band","step_group":"finance"},
    {"id":"preapproval","prompt":"Pre-approval","type":"single_select","options":["Not required","Pending","Obtained","Expired","Need help"],"maps_to_field":"finance.preapproval","step_group":"finance"},
    {"id":"preapproval_amount","prompt":"Pre-approval amount","type":"number","show_when":{"in":["finance.preapproval",["Obtained","Expired"]]},"maps_to_field":"finance.preapproval_amount","step_group":"finance"},
    {"id":"preapproval_expiry","prompt":"Pre-approval expiry","type":"date","show_when":{"in":["finance.preapproval",["Obtained","Expired"]]},"required_when":{"in":["finance.preapproval",["Obtained","Expired"]]},"maps_to_field":"finance.preapproval_expiry","step_group":"finance"},

    

    {"id":"property_types","prompt":"Property types","type":"multi_select","options":["House","Townhouse","Unit/Apartment","Dual income"],"required_when":{"const":true},"maps_to_field":"brief.property_types","step_group":"property"},
    {"id":"beds_min","prompt":"Bedrooms (min)","type":"number","maps_to_field":"brief.beds_min","step_group":"property"},
    {"id":"baths_min","prompt":"Bathrooms (min)","type":"number","maps_to_field":"brief.baths_min","step_group":"property"},

    {"id":"target_states","prompt":"Target states","type":"multi_select","options":["NSW","VIC","QLD","SA","WA","TAS","ACT","NT"],"required_when":{"const":true},"maps_to_field":"locations.states","step_group":"location"},
    {"id":"open_to_suggestions","prompt":"Open to data-led suggestions","type":"toggle","maps_to_field":"locations.open_to_suggestions","step_group":"location"},
    {"id":"accept_drivers","prompt":"What makes a location acceptable? (up to 3)","type":"multi_select","options":["Rent growth","Low vacancy","Infrastructure","Price point","Schools","Commute"],"show_when":{"eq":["locations.open_to_suggestions",false]},"required_when":{"eq":["locations.open_to_suggestions",false]},"validation":{"max":3},"maps_to_field":"locations.acceptability_drivers","step_group":"location"},

    {"id":"comparables","prompt":"Example properties","type":"group","maps_to_field":"comparables","step_group":"comparables"}
  ]
}
